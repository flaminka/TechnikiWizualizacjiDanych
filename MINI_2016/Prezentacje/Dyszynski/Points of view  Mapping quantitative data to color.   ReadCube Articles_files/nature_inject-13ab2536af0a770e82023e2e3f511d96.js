function parseUri(e){for(var t=parseUri.options,n=t.parser[t.strictMode?"strict":"loose"].exec(e),o={},r=14;r--;)o[t.key[r]]=n[r]||"";return o[t.q.name]={},o[t.key[12]].replace(t.q.parser,function(e,n,r){n&&(o[t.q.name][n]=r)}),o}var requirejs,require,define;!function(e){function t(e,t){return b.call(e,t)}function n(e,t){var n,o,r,i,a,s,c,u,l,d,f=t&&t.split("/"),p=h.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(f=f.slice(0,f.length-1),e=f.concat(e.split("/")),u=0;u<e.length;u+=1)if(d=e[u],"."===d)e.splice(u,1),u-=1;else if(".."===d){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((f||m)&&p){for(n=e.split("/"),u=n.length;u>0;u-=1){if(o=n.slice(0,u).join("/"),f)for(l=f.length;l>0;l-=1)if(r=p[f.slice(0,l).join("/")],r&&(r=r[o])){i=r,a=u;break}if(i)break;!s&&m&&m[o]&&(s=m[o],c=u)}!i&&s&&(i=s,a=c),i&&(n.splice(0,a,i),e=n.join("/"))}return e}function o(t,n){return function(){return l.apply(e,v.call(arguments,0).concat([t,n]))}}function r(e){return function(t){return n(t,e)}}function i(e){return function(t){p[e]=t}}function a(n){if(t(m,n)){var o=m[n];delete m[n],g[n]=!0,u.apply(e,o)}if(!t(p,n)&&!t(g,n))throw new Error("No "+n);return p[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return h&&h.config&&h.config[e]||{}}}var u,l,d,f,p={},m={},h={},g={},b=Object.prototype.hasOwnProperty,v=[].slice;d=function(e,t){var o,i=s(e),c=i[0];return e=i[1],c&&(c=n(c,t),o=a(c)),c?e=o&&o.normalize?o.normalize(e,r(t)):n(e,t):(e=n(e,t),i=s(e),c=i[0],e=i[1],c&&(o=a(c))),{f:c?c+"!"+e:e,n:e,pr:c,p:o}},f={require:function(e){return o(e)},exports:function(e){var t=p[e];return"undefined"!=typeof t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:c(e)}}},u=function(n,r,s,c){var u,l,h,b,v,_,y=[],w=typeof s;if(c=c||n,"undefined"===w||"function"===w){for(r=!r.length&&s.length?["require","exports","module"]:r,v=0;v<r.length;v+=1)if(b=d(r[v],c),l=b.f,"require"===l)y[v]=f.require(n);else if("exports"===l)y[v]=f.exports(n),_=!0;else if("module"===l)u=y[v]=f.module(n);else if(t(p,l)||t(m,l)||t(g,l))y[v]=a(l);else{if(!b.p)throw new Error(n+" missing "+l);b.p.load(b.n,o(c,!0),i(l),{}),y[v]=p[l]}h=s?s.apply(p[n],y):void 0,n&&(u&&u.exports!==e&&u.exports!==p[n]?p[n]=u.exports:h===e&&_||(p[n]=h))}else n&&(p[n]=s)},requirejs=require=l=function(t,n,o,r,i){return"string"==typeof t?f[t]?f[t](n):a(d(t,n).f):(t.splice||(h=t,n.splice?(t=n,n=o,o=null):t=e),n=n||function(){},"function"==typeof o&&(o=r,r=i),r?u(e,t,n,o):setTimeout(function(){u(e,t,n,o)},4),l)},l.config=function(e){return h=e,h.deps&&l(h.deps,h.callback),l},requirejs._defined=p,define=function(e,n,o){n.splice||(o=n,n=[]),t(p,e)||t(m,e)||(m[e]=[e,n,o])},define.amd={jQuery:!0}}(),define("enviroment",function(){function e(e){return e.toLowerCase()==s}function t(){return s}function n(){return e("development")}function o(){return e("staging")}function r(){return e("production")}function i(){/^http(s)?:\/\/(www\.)?readcube\.com\/$/i.test(c)?s="production":/^http(s)?:\/\/staging\.readcube\.com\/$/i.test(c)?s="staging":/^http(s)?:\/\/local\.readcube\.com(:\d+)?\/$/i.test(c)&&(s="development")}var a={},s="unknown",c="https://www.readcube.com/";return i(),a.is=e,a.get=t,a.staging=o,a.production=r,a.development=n,a}),function(e,t){"function"==typeof define&&define.amd?define("uri-tools",[],t):e.uri_tools=t()}(window,function(){function e(e){var t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function t(e,t){return[e.replace(/(\/+)$/,""),encodeURIComponent(t.replace(/^(\/+)/,""))].join("/")}function n(t,n){var o=t.split("#");return o[0]+=-1==o[0].indexOf("?")?"?":"&",o[0]+=e(n),o.join("#")}function o(e){return/readcube\.com(:\d+)?$/.test(e)}return{add_path:t,add_params:n,readcube_origin:o}}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},r=function(){return n.apply(this instanceof o&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,r.prototype=new o,r}),Date.now||(Date.now=function(){return(new Date).getTime()}),define("util",["enviroment","uri-tools"],function(e,t){function n(){try{if(e.production()&&!localStorage.getItem("readcube-console-log"))return;return Array.prototype.unshift.call(arguments,"[READCUBE]"),"function"==typeof console.log.apply?console.log.apply(console,arguments):Function.prototype.bind.call(console.log,console).apply(console,arguments)}catch(t){}}function o(){try{var e=document.createElement("div");e.id="readcube-log-msg",e.style.display="none",e.style.position="absolute",e.innerHTML=Array.prototype.slice.call(arguments,0).join(" "),document.documentElement.appendChild(e)}catch(t){}}function r(e){e&&e.message&&n("fail message:",e.message),e&&e.stack&&n("stack trace:",e.stack)}function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}function a(e){setTimeout(e,0)}function s(e){return $.extend(!0,{},e)}function c(){return Array.prototype.splice.call(arguments,0,0,!0,{}),$.extend.apply($,arguments)}function u(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function l(e){return"string"==typeof e&&/^\d{4}-\d{3}(\d|x){1}$/i.test(e)}function d(e,t){var n=document.createElement("link");if(n.type="text/css",n.rel="stylesheet",n.href=e,document.getElementsByTagName("head")[0].appendChild(n),t){var o=document.createElement("img");o.onerror=t,o.src=e}}function f(e,t){var n=document.createElement("script"),o=document.getElementsByTagName("head")[0];n.onload=n.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(n.onload=n.onreadystatechange=null,t())},n.src=e,o.appendChild(n)}function p(e,t){function o(){return"undefined"!=typeof jQuery}if(o())t(window.$=jQuery);else{var r=location.protocol+"//ajax.googleapis.com/ajax/libs/jquery/"+e+"/jquery.min.js";f(r,function(){o()?t(window.$=jQuery):n("failed to load jQuery.")})}}function m(e,t){try{var n=document.createEvent("HTMLEvents");n.initEvent(e,!1,!1),(t||document).dispatchEvent(n)}catch(o){}}function h(e){return{width:e[0].offsetWidth,height:e[0].offsetHeight}}function g(){return g.md?g.md:(g.md=$("<div></div>").css({position:"absolute",visibility:"hidden"}).appendTo(document.body),g.md)}function b(e){if(document.body.contains(e[0]))return h(e);e=e.clone(),e.appendTo(g());var t=h(e);return e.remove(),t}function v(e){for(var t={top:+1/0,left:+1/0,bottom:-1/0,right:-1/0},n=0;n<e.length;n++){var o=e[n].getBoundingClientRect();t.top=Math.min(t.top,o.top),t.left=Math.min(t.left,o.left),t.bottom=Math.max(t.bottom,o.bottom),t.right=Math.max(t.right,o.right)}return t}var _=function(){var e={};return{tic:function(){var t=i();return e[t]=Date.now(),t},toc:function(t){var n=Date.now()-e[t];return delete e[t],n}}}();return{log:n,guid:i,clone:s,merge:c,invert:u,timer:_,queue_exec:a,issn_valid:l,get_style:d,get_script:f,secure_jquery:p,dispatch_event:m,log_to_html:o,log_promise_fail:r,get_bounding_rect:v,measure_element:b,add_path:t.add_path,add_params:t.add_params,readcube_origin:t.readcube_origin}}),define("asset",function(){var e={"modals.css":"https://d3jitpq7h831d5.cloudfront.net/assets/modals-bd2515643cd91db7be02c742622c6dd4.css","popover.css":"https://d3jitpq7h831d5.cloudfront.net/assets/popover-5a939cf55abf34a88e15b3022ed0b41b.css","dashboard.css":"https://d3jitpq7h831d5.cloudfront.net/assets/dashboard-30188559ff3ad5948996dfddf33bcf25.css","wiley_checkout_new.css":"https://d3jitpq7h831d5.cloudfront.net/assets/wiley_checkout_new-51adeaa961e856fc5e191ad8e51cae34.css","green-preview.png":"https://d3jitpq7h831d5.cloudfront.net/assets/green-preview-0567f57b4b0ef671f07b74f9a2de18e9.png","green-preview-2x.png":"https://d3jitpq7h831d5.cloudfront.net/assets/green-preview-2x-16a8e6c2e781e837745bfbd60dbbef03.png","jquery.fancybox-1.3.4.css":"//cdnjs.cloudflare.com/ajax/libs/fancybox/1.3.4/jquery.fancybox-1.3.4.css","jquery.fancybox-1.3.4.js":"//cdnjs.cloudflare.com/ajax/libs/fancybox/1.3.4/jquery.fancybox-1.3.4.pack.min.js","jquery.fancybox-2.1.5.css":"//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css","jquery.fancybox-2.1.5.js":"//cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js","webfont.js":"//ajax.googleapis.com/ajax/libs/webfont/1.5.3/webfont.js","preloader-64.gif":"//media.readcube.com/epdf/preloader-64.gif"};return function(t){return e[t]}}),define("load-asset",["util","asset"],function(e,t){function n(e,t){return setTimeout(e||function(){},t||u)}function o(e,t){var n=arguments.callee.caller.name;return null!=e&&(n+="-"+e),c[e]?c[e]:c[e]=t()}function r(r){return o(r,function(){return new Promise(function(o,i){e.get_script(t(r),o),n(function(){i({message:"load_script_timeout"})})})})}function i(r){return o(r,function(){return new Promise(function(o,i){e.get_style(t(r),o),n(function(){i({message:"load_style_timeout"})})})})}function a(t){return o(t,function(){return new Promise(function(o,r){e.secure_jquery(t,o),n(function(){r({message:"load_jquery_timeout"})})})})}function s(e){return o(e,function(){return new Promise(function(t,n){$.fancybox?t():Promise.all([r("jquery.fancybox-"+e+".js"),i("jquery.fancybox-"+e+".css")]).then(t,n)})})}var c={},u=3e4;return{style:i,script:r,jquery:a,fancybox:s}}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,o;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),i=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),o=0;i>o;){var a;o in r&&(a=r[o],e.call(n,a,o,r)),o++}}),define("deparam",function(){return function(e,t){function n(e){returnvalue="";try{returnvalue=decodeURIComponent(e)}catch(t){returnvalue=unescape(e)}return returnvalue}var o={},r={"true":!0,"false":!1,"null":null};return"string"!=typeof e?o:("undefined"==typeof t&&(t=!0),e.replace(/\+/g," ").split("&").forEach(function(e){var i,a=e.split("="),s=n(a[0]),c=o,u=0,l=s.split("]["),d=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[d])?(l[d]=l[d].replace(/\]$/,""),l=l.shift().split("[").concat(l),d=l.length-1):d=0,2===a.length)if(i=n(a[1]),t&&(i=i&&!isNaN(i)?+i:"undefined"===i?void 0:void 0!==r[i]?r[i]:i),d)for(;d>=u;u++)s=""===l[u]?c.length:l[u],c=c[s]=d>u?c[s]||(l[u+1]&&isNaN(l[u+1])?{}:[]):i;else Array.isArray(o[s])?o[s].push(i):o[s]=void 0!==o[s]?[o[s],i]:i;else s&&(o[s]=t?void 0:"")}),o)}}),define("hash-command",["deparam"],function(e){function t(e){location.hash!=e&&(location.hash=e)}function n(){history.replaceState(null,null,location.href.split("#")[0])}function o(e,t){e&&t&&location.reload()}function r(e){var t=!1;switch(location.hash){case"#enable-readcube-share":t=!localStorage.getItem(f),localStorage.setItem(f,1),o(t,e);break;case"#disable-readcube-share":t=!!localStorage.getItem(f),localStorage.removeItem(f),o(t,e);break;case"#enable-readcube-epdf":t=!localStorage.getItem(p),localStorage.setItem(p,1),o(t,e);break;case"#disable-readcube-epdf":t=!!localStorage.getItem(p),localStorage.removeItem(p),o(t,e);break;case"#enable-readcube-debug-visual":t=!localStorage.getItem(m),localStorage.setItem(m,1),o(t,e);break;case"#disable-readcube-debug-visual":t=!!localStorage.getItem(m),localStorage.removeItem(m),o(t,e);break;case"#enable-readcube-console-log":t=!localStorage.getItem(h),localStorage.setItem(h,1),o(t,e);break;case"#disable-readcube-console-log":t=!!localStorage.getItem(h),localStorage.removeItem(h),o(t,e)}}function i(){return 0==location.hash.indexOf(l)}function a(){return 0==location.hash.indexOf(d)}function s(){var t=location.hash.split(":")[1];return t?e(t):null}function c(){t("#")}function u(e){t(e?l+":"+e:l)}var l="#readcube-epdf",d="#readcube-settings",f="readcube-share-enabled",p="readcube-epdf-enabled",m="readcube-debug-visual",h="readcube-console-log";return{process_settings:r,is_reader_open:i,is_dashboard_open:a,get_hash_params:s,remove_hash_silent:n,close_reader:c,open_reader:u}}),define("mobile-detect",function(){function e(){var e={Android:function(){return/Android/i.test(n)},BlackBerry:function(){return/BlackBerry/i.test(n)},iOS:function(){return/iPhone|iPad|iPod/i.test(n)},Opera:function(){return/Opera Mini/i.test(n)},Windows:function(){/IEMobile/i.test(n)}};for(var t in e)if(e[t]())return!0;return!1}function t(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4))}var n=navigator.userAgent||navigator.vendor||window.opera;return function(){return e()||t()}}),define("subpixelfont-test",function(){return function(){var e=document.getElementsByTagName("body")[0],t=document.createElement("div");t.style.position="absolute",t.style.visibility="hidden",t.style.fontFamily='"Georgia"',t.innerHTML="PICS",e.appendChild(t);var n=10,o=4,r=.1;t.style.fontSize=n+"px";var i=t.offsetWidth;t.style.fontSize=n*o+"px";var a=t.offsetWidth;return e.removeChild(t),Math.abs(a/i-o)<r}}),define("modernizr",function(){return function(e,t,n){function o(e){v.cssText=e}function r(e,t){return o(y.join(e+";")+(t||""))}function i(e,t){return typeof e===t}function a(e,t){return!!~(""+e).indexOf(t)}function s(e,t){for(var o in e){var r=e[o];if(!a(r,"-")&&v[r]!==n)return"pfx"==t?r:!0}return!1}function c(e,t,o){for(var r in e){var a=t[e[r]];if(a!==n)return o===!1?e[r]:i(a,"function")?a.bind(o||t):a}return!1}function u(e,t,n){var o=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+x.join(o+" ")+o).split(" ");return i(t,"string")||i(t,"undefined")?s(r,t):(r=(e+" "+k.join(o+" ")+o).split(" "),c(r,t,n))}var l,d,f,p="2.8.3",m={},h=t.documentElement,g="modernizr",b=t.createElement(g),v=b.style,_=":)",y=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),w="Webkit Moz O ms",x=w.split(" "),k=w.toLowerCase().split(" "),j={svg:"http://www.w3.org/2000/svg"},$={},T=[],P=T.slice,E=function(e,n,o,r){var i,a,s,c,u=t.createElement("div"),l=t.body,d=l||t.createElement("body");if(parseInt(o,10))for(;o--;)s=t.createElement("div"),s.id=r?r[o]:g+(o+1),u.appendChild(s);return i=["&#173;",'<style id="s',g,'">',e,"</style>"].join(""),u.id=g,(l?u:d).innerHTML+=i,d.appendChild(u),l||(d.style.background="",d.style.overflow="hidden",c=h.style.overflow,h.style.overflow="hidden",h.appendChild(d)),a=n(u,e),l?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),h.style.overflow=c),!!a},S=function(){function e(e,r){r=r||t.createElement(o[e]||"div"),e="on"+e;var a=e in r;return a||(r.setAttribute||(r=t.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(e,""),a=i(r[e],"function"),i(r[e],"undefined")||(r[e]=n),r.removeAttribute(e))),r=null,a}var o={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return e}(),I={}.hasOwnProperty;f=i(I,"undefined")||i(I.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return I.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=P.call(arguments,1),o=function(){if(this instanceof o){var r=function(){};r.prototype=t.prototype;var i=new r,a=t.apply(i,n.concat(P.call(arguments)));return Object(a)===a?a:i}return t.apply(e,n.concat(P.call(arguments)))};return o}),$.flexbox=function(){return u("flexWrap")},$.flexboxlegacy=function(){return u("boxDirection")},$.postmessage=function(){return!!e.postMessage},$.hashchange=function(){return S("hashchange",e)&&(t.documentMode===n||t.documentMode>7)},$.history=function(){return!(!e.history||!history.pushState)},$.rgba=function(){return o("background-color:rgba(150,255,150,.5)"),a(v.backgroundColor,"rgba")},$.backgroundsize=function(){return u("backgroundSize")},$.borderradius=function(){return u("borderRadius")},$.boxshadow=function(){return u("boxShadow")},$.textshadow=function(){return""===t.createElement("div").style.textShadow},$.opacity=function(){return r("opacity:.55"),/^0.55$/.test(v.opacity)},$.cssgradients=function(){var e="background-image:",t="gradient(linear,left top,right bottom,from(#9f9),to(white));",n="linear-gradient(left top,#9f9, white);";return o((e+"-webkit- ".split(" ").join(t+e)+y.join(n+e)).slice(0,-e.length)),a(v.backgroundImage,"gradient")},$.csstransforms=function(){return!!u("transform")},$.csstransforms3d=function(){var e=!!u("perspective");return e&&"webkitPerspective"in h.style&&E("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(t){e=9===t.offsetLeft&&3===t.offsetHeight}),e},$.csstransitions=function(){return u("transition")},$.fontface=function(){var e;return E('@font-face {font-family:"font";src:url("https://")}',function(n,o){var r=t.getElementById("smodernizr"),i=r.sheet||r.styleSheet,a=i?i.cssRules&&i.cssRules[0]?i.cssRules[0].cssText:i.cssText||"":"";e=/src/i.test(a)&&0===a.indexOf(o.split(" ")[0])}),e},$.generatedcontent=function(){var e;return E(["#",g,"{font:0/0 a}#",g,':after{content:"',_,'";visibility:hidden;font:3px/1 a}'].join(""),function(t){e=t.offsetHeight>=3}),e},$.video=function(){var e=t.createElement("video"),n=!1;try{(n=!!e.canPlayType)&&(n=new Boolean(n),n.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(o){}return n},$.localstorage=function(){try{return localStorage.setItem(g,g),localStorage.removeItem(g),!0}catch(e){return!1}},$.svg=function(){return!!t.createElementNS&&!!t.createElementNS(j.svg,"svg").createSVGRect};for(var C in $)f($,C)&&(d=C.toLowerCase(),m[d]=$[C](),T.push((m[d]?"":"no-")+d));return m.addTest=function(e,t){if("object"==typeof e)for(var o in e)f(e,o)&&m.addTest(o,e[o]);else{if(e=e.toLowerCase(),m[e]!==n)return m;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(h.className+=" "+(t?"":"no-")+e),m[e]=t}return m},o(""),b=l=null,m._version=p,m._prefixes=y,m._domPrefixes=k,m._cssomPrefixes=x,m.hasEvent=S,m.testProp=function(e){return s([e])},m.testAllProps=u,m.testStyles=E,m}(this,this.document)}),define("compatible",["util","mobile-detect","subpixelfont-test","modernizr"],function(e,t,n,o){function r(){return"WebkitAppearance"in document.documentElement.style}function i(){if(t())return e.log("browser is mobile"),{result:!1,message:"mobile_browser"};if(!r()&&!n())return e.log("browser does not support subpixel font rendering"),{result:!1,message:"font_fail"};for(var i=0;i<a.length;i++){var s=a[i];if("string"!=typeof s){for(var c=!1,u=0;u<s.length;u++)if(o[s[u]]){c=!0;break}if(!c)return e.log("browser does not support "+s.join(" or ")),{result:!1,message:"unsupported_browser"}}else if(!o[s])return e.log("browser does not support "+s),{result:!1,message:"unsupported_browser"}}return{result:!0}}var a=[["flexbox","flexboxlegacy"],"fontface","backgroundsize","borderradius","boxshadow","opacity","rgba","textshadow","cssgradients","csstransforms","csstransitions","hashchange","history","video","localstorage","postmessage","svg"];return i}),function(e,t){"function"==typeof define&&define.amd?define("get-article-size",[],t):e.get_article_size=t()}(window,function(){return function(e){var t=new XMLHttpRequest;return t.open(e.type,e.url),t.onreadystatechange=function(){if(this.readyState==this.HEADERS_RECEIVED){if(200==this.status){var t=this.getResponseHeader("Content-Type"),n=this.getResponseHeader("Content-Length");/application\/(octet-stream|pdf|FLPDF)/i.test(t)?e.done(n):e.fail(this.status)}else e.fail(this.status);this.onreadystatechange=null,this.abort()}},t.send(),t}}),parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},define("size-check",["util","get-article-size"],function(e,t){function n(t){var n=parseUri(t).host;return e.readcube_origin(n)?!0:(e.log("disallowed parent origin:",n),!1)}function o(n,o){var r=parseUri(n).host,i=parseUri(location.toString()).host;i!=r&&(n=n.replace(r,i)),n=n.replace(/(\/\/[^\/]+)/,"$1/forwarder"),t({type:"GET",url:e.add_params(n,{src:"readcube"}),done:function(){window.parent.postMessage({type:"pdf_size",size:1337},o)},fail:function(e){window.parent.postMessage({type:"pdf_size_fail",status:e},o)}})}function r(){var e=parseUri(location.toString()),t=e.queryKey.pdf_url,r=e.queryKey.parent_url;return t&&r?(t=decodeURIComponent(t),r=decodeURIComponent(r),n(r)?(o(t,r),!0):!1):!1}return{init:r}}),define("modal",function(){function e(){function e(){return $("<div></div>").css(o)}function i(){return $("<div></div>").css(r)}function a(){var e=$(document.body);p.scrollTop=e.scrollTop(),p.overflow=e.css("overflow"),e.scrollTop(0),e.css("overflow","hidden")}function s(){var e=$(document.body);e.css("overflow",p.overflow),e.scrollTop(p.scrollTop)}function c(o){return f||l?!1:(a(),f=!0,l=e(),d=i(),l.appendTo(document.body),d.appendTo(document.body),o.appendTo(d),d.css({width:o.outerWidth(),height:o.outerHeight()}),l.click(function(){return u(),!1}),l.fadeIn(t,function(){d.animate({top:"0%",bottom:"0%"},n,function(){f=!1})}),$(window).bind("keydown.modal",function(e){27==e.keyCode&&u()}),!0)}function u(){return f||!l?!1:(f=!0,d.animate({top:"-100%",bottom:"100%"},n,function(){d.remove(),d=null,l.fadeOut(t,function(){s(),l.remove(),l=null,f=!1})}),$(window).unbind("keydown.modal"),!0)}var l=null,d=null,f=!1,p={};return{open:c,close:u}}var t=200,n=400,o={display:"none",position:"absolute",top:0,left:0,bottom:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:1e3},r={position:"absolute",top:"-100%",left:0,bottom:"100%",right:0,margin:"auto auto",outline:"none",border:"none",borderRadius:"6px",backgroundColor:"white",boxShadow:"0 0 6px 3px rgba(0, 0, 0, 0.4)",zIndex:1100,overflow:"hidden"};return e}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),"function"!=typeof Object.create&&(Object.create=function(){var e=function(){};return function(t){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof t)throw TypeError("Argument must be an object");e.prototype=t;var n=new e;return e.prototype=null,n}}()),function e(t,n,o){function r(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return r(n?n:e)},l,l.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t){function n(){}var o=t.exports={};o.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var o=n.shift();o()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),o.title="browser",o.browser=!0,o.env={},o.argv=[],o.on=n,o.addListener=n,o.once=n,o.off=n,o.removeListener=n,o.removeAllListeners=n,o.emit=n,o.binding=function(){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(){throw new Error("process.chdir is not supported")}},{}],2:[function(e,t){"use strict";function n(e){function t(e){return null===u?void d.push(e):void i(function(){var t=u?e.onFulfilled:e.onRejected;if(null===t)return void(u?e.resolve:e.reject)(l);var n;try{n=t(l)}catch(o){return void e.reject(o)}e.resolve(n)})}function a(e){try{if(e===f)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void r(t.bind(e),a,s)}u=!0,l=e,c()}catch(n){s(n)}}function s(e){u=!1,l=e,c()}function c(){for(var e=0,n=d.length;n>e;e++)t(d[e]);d=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var u=null,l=null,d=[],f=this;this.then=function(e,r){return new n(function(n,i){t(new o(e,r,n,i))})},r(e,a,s)}function o(e,t,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=o}function r(e,t,n){var o=!1;try{e(function(e){o||(o=!0,t(e))},function(e){o||(o=!0,n(e))})}catch(r){if(o)return;o=!0,n(r)}}var i=e("asap");t.exports=n},{asap:4}],3:[function(e,t){"use strict";function n(e){this.then=function(t){return"function"!=typeof t?this:new o(function(n,o){r(function(){try{n(t(e))}catch(r){o(r)}})})}}var o=e("./core.js"),r=e("asap");t.exports=o,n.prototype=Object.create(o.prototype);var i=new n(!0),a=new n(!1),s=new n(null),c=new n(void 0),u=new n(0),l=new n("");o.resolve=function(e){if(e instanceof o)return e;if(null===e)return s;if(void 0===e)return c;if(e===!0)return i;if(e===!1)return a;if(0===e)return u;if(""===e)return l;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new o(t.bind(e))}catch(r){return new o(function(e,t){t(r)})}return new n(e)},o.from=o.cast=function(e){var t=new Error("Promise.from and Promise.cast are deprecated, use Promise.resolve instead");return t.name="Warning",console.warn(t.stack),o.resolve(e)},o.denodeify=function(e,t){return t=t||1/0,function(){var n=this,r=Array.prototype.slice.call(arguments);return new o(function(o,i){for(;r.length&&r.length>t;)r.pop();r.push(function(e,t){e?i(e):o(t)}),e.apply(n,r)})}},o.nodeify=function(e){return function(){var t=Array.prototype.slice.call(arguments),n="function"==typeof t[t.length-1]?t.pop():null;try{return e.apply(this,arguments).nodeify(n)}catch(i){if(null===n||"undefined"==typeof n)return new o(function(e,t){t(i)});r(function(){n(i)})}}},o.all=function(){var e=1===arguments.length&&Array.isArray(arguments[0]),t=Array.prototype.slice.call(e?arguments[0]:arguments);if(!e){var n=new Error("Promise.all should be called with a single array, calling it with multiple arguments is deprecated");n.name="Warning",console.warn(n.stack)}return new o(function(e,n){function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){o(i,e)},n)}t[i]=a,0===--r&&e(t)}catch(c){n(c)}}if(0===t.length)return e([]);for(var r=t.length,i=0;i<t.length;i++)o(i,t[i])})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){e.forEach(function(e){o.resolve(e).then(t,n)})})},o.prototype.done=function(){var e=arguments.length?this.then.apply(this,arguments):this;e.then(null,function(e){r(function(){throw e})})},o.prototype.nodeify=function(e){return"function"!=typeof e?this:void this.then(function(t){r(function(){e(null,t)})},function(t){r(function(){e(t)})})},o.prototype["catch"]=function(e){return this.then(null,e)}},{"./core.js":2,asap:4}],4:[function(e,t){(function(e){function n(){for(;r.next;){r=r.next;var e=r.task;r.task=void 0;var t=r.domain;t&&(r.domain=void 0,t.enter());try{e()}catch(o){if(c)throw t&&t.exit(),setTimeout(n,0),t&&t.enter(),o;setTimeout(function(){throw o},0)}t&&t.exit()}a=!1}function o(t){i=i.next={task:t,domain:c&&e.domain,next:null},a||(a=!0,s())}var r={task:void 0,next:null},i=r,a=!1,s=void 0,c=!1;if("undefined"!=typeof e&&e.nextTick)c=!0,s=function(){e.nextTick(n)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,n):function(){setImmediate(n)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=n,s=function(){u.port2.postMessage(0)}}else s=function(){setTimeout(n,0)};t.exports=o}).call(this,e("_process"))},{_process:1}],5:[function(){Promise.prototype.done||(Promise.prototype.done=function(e,t){var n="function"==typeof e||"function"==typeof t?this.then(e,t):this;n.then(null,function(e){setTimeout(function(){throw e},0)})})},{}],6:[function(e){"undefined"==typeof Promise?Promise=e("promise"):e("./polyfill-done.js")},{"./polyfill-done.js":5,promise:3}]},{},[6]),define("dashboard",["util","asset","hash-command","modal"],function(e,t,n,o){function r(e){return $('<input type="checkbox"'+(e?" checked":"")+">")}function i(e){return!!localStorage.getItem(e)}function a(e){var t=r(i(e.key));return t.click(function(){i(e.key)?localStorage.removeItem(e.key):localStorage.setItem(e.key,1)}),t}function s(e){var t=$("<tr></tr>"),n=$("<td></td>").appendTo(t),o=$("<td></td>").appendTo(t);return n.append(e.label),o.append(a(e)),t}function c(){for(var e=$('<table class="table"></table>'),t=0;t<v.length;t++)e.append(s(v[t]));return e}function u(){return $('<div class="btn btn-primary reload">Reload</div>').click(function(){location.reload(!0),b.close()})}function l(){n.is_dashboard_open()&&(n.remove_hash_silent(),h())}function d(){l(),$(window).bind("hashchange",l)}function f(){window.readcube_settings=h}function p(){return $('<div id="r3-dashboard"></div>').css({width:340,height:340}).append('<div class="title">ReadCube Settings</div>').append(c()).append(u())}function m(){var n=arguments.callee;return n.retval||(n.retval=new Promise(function(n){e.get_style(t("dashboard.css"),n)}))}function h(){m().then(function(){b.open(p())})["catch"](e.log_promise_fail)}function g(){f(),d()}var b=o(),v=[{key:"readcube-share-enabled",label:"share enabled"},{key:"readcube-epdf-enabled",label:"epdf enabled"},{key:"readcube-debug-visual",label:"visual debug"},{key:"readcube-console-log",label:"console log"}];return{init:g}}),window.location.origin||(window.location.origin=[window.location.protocol+"//",window.location.hostname,window.location.port?":"+window.location.port:""].join("")),define("endpoint",["util","enviroment"],function(e){function t(){return Array.prototype.slice.call(arguments,0).join("/").replace(/[\/]+/g,"/").replace(/\/\?/g,"?").replace(/\/\#/g,"#").replace(/\:\//g,"://")}var n={manifestor:"https://content.readcube.com/",services:"https://services.readcube.com/",website:"https://www.readcube.com/",webreader:"http://www.readcube.com/articles/"},o={website:n.website,services:n.services,manifestor:n.manifestor,webreader:n.webreader,login:t(n.website,"session/new"),register:t(n.website,"user/new"),checkout:t(n.website,"checkout/new"),account:t(n.website,"account"),injection_settings:t(n.services,"journals/injection_settings"),html_status:t(n.manifestor,"html_status"),user_info:t(n.services,"auth/user_info"),readcube_access:t(n.services,"purchases/check_access"),referrer_access:t(n.services,"access/referrer"),purchases_info:t(n.services,"purchases/info"),article_status:t(n.manifestor,"article_status"),service_status:t(n.website,"status/ping"),remote_sign_out:t(n.website,"remote/sign_out"),track_checkout_show:t(n.website,"tracking/checkout_show"),track_checkout_fail:t(n.website,"tracking/checkout_fail"),whats_this:t(n.website,"access"),sharing_toolbar:t(n.website,"reader_v2/share"),checkout_facade:t(n.website,"checkout/facade"),wiley_log:t(location.origin,"readcube/log")};
return function(t,n){if(!o[t])return null;if(n){if(n=e.clone(n),n._PATH_){var r=n._PATH_;return delete n._PATH_,e.add_params(e.add_path(o[t],r),n)}return e.add_params(o[t],n)}return o[t]}}),define("ajax-api",["util","endpoint","enviroment"],function(e,t,n){function o(e,t){return setTimeout(e||function(){},t||p)}function r(n,r){e.log("fetching user info...");var i=e.timer.tic(),a=o(r);$.ajax({url:t("user_info"),dataType:"jsonp",success:function(t){e.log("user info fetching complete:",e.timer.toc(i)+"ms",t),clearTimeout(a),n&&n(t)}})}function i(n,r,i){e.log("checking article availability...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("html_status",{doi:n}),dataType:"jsonp",success:function(t){e.log("availability check complete:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}function a(n,r,i){e.log("fetching article status...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("article_status",{doi:n}),dataType:"jsonp",success:function(t){e.log("article status fetched:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}function s(n,r,i){e.log("fetching purchases info...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("purchases_info",{doi:n}),dataType:"jsonp",success:function(t){e.log("purchases info fetched:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}function c(n,r){e.log("fetching service status...");var i=e.timer.tic(),a=o(r);$.ajax({url:t("service_status"),dataType:"jsonp",success:function(t){e.log("service status fetched:",e.timer.toc(i)+"ms",t),clearTimeout(a),n&&n(t)}})}function u(n,r,i){e.log("checking injection settings...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("injection_settings",n),dataType:"jsonp",success:function(t){e.log("settings check complete:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}function l(t,n,r){e.log("checking jsonp access...");var i=e.timer.tic(),a=o(r);$.ajax(e.merge(t,{dataType:"jsonp",success:function(t){e.log("jsonp access response:",e.timer.toc(i)+"ms",t),clearTimeout(a),n&&n(t)}}))}function d(n,r,i){e.log("checking readcube access...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("readcube_access",{doi:n}),dataType:"jsonp",success:function(t){e.log("readcube access response:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}function f(n,r,i){e.log("checking referrer access...");var a=e.timer.tic(),s=o(i);$.ajax({url:t("referrer_access",n),dataType:"jsonp",success:function(t){e.log("referrer access response:",e.timer.toc(a)+"ms",t),clearTimeout(s),r&&r(t)}})}var p=n.production()?8e3:16e3;return{get_user_info:r,get_html_status:i,get_article_status:a,get_purchases_info:s,get_service_status:c,get_injection_settings:u,get_readcube_access:d,get_jsonp_access:l,get_referrer_access:f}}),define("ajax-promise",["ajax-api"],function(e){function t(t,n){return function(o,r){e[t].apply(e,n.concat(function(e){o(e)},function(){r({error:"timeout",message:t+"_timeout"})}))}}function n(){var e=arguments[0],n=Array.prototype.slice.call(arguments,1);return new Promise(t(e,n))}return{create:n}}),define("status",["enviroment","ajax-promise"],function(e,t){function n(e,t){var n=arguments.callee.caller.name;return null!=e&&(n+="-"+e),a[e]?a[e]:a[e]=t()}function o(){return n(null,function(){return new Promise(function(n,o){e.production()||(o=n),t.create("get_service_status").then(function(e){"ok"==e.status?n(e):o({message:"service_unavailable"})},o)})})}function r(e){return n(e,function(){return new Promise(function(n,o){t.create("get_article_status",e).then(function(e){"ok"==e.status?n(e):o({message:"article_"+e.status})},o)})})}function i(e){return n(e,function(){return new Promise(function(n,o){t.create("get_html_status",e).then(function(e){"ok"==e.status?n(e):o({message:"html_unavailable"})},o)})})}var a={};return{service:o,article:r,html:i}}),define("page",function(){function e(e){if(1==e.length)n=e[0];else for(var t=0;t<e.length;t++)if(e[t].test()){n=e[t];break}}function t(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return o[e]?o[e].apply(o,t):n&&n[e]?n[e].apply(n,t):null}var n=null,o={init:e};return t}),define("reader-styles",{spinner:{color:"#FFF",radius:20,length:36,width:2},background:{base:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.6)"},hide:{visibility:"hidden",top:"-100%",bottom:"100%",zIndex:0},show:{visibility:"visible",top:"0%",bottom:"0%",zIndex:2e6}},frame:{base:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none",outline:"none"},hide:{visibility:"hidden",top:"-100%",bottom:"100%"},show:{visibility:"visible",top:"0%",bottom:"0%"}}}),function(e,t){e.Spinner=t(),"function"==typeof define&&define.amd&&define("spin",[],function(){return e.Spinner})}(this,function(){"use strict";function e(e,t){var n,o=document.createElement(e||"div");for(n in t)o[n]=t[n];return o}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,o){var r=["opacity",t,~~(100*e),n,o].join("-"),i=.01+n/o*100,a=Math.max(1-(1-e)/t*(100-i),e),s=l.substring(0,l.indexOf("Animation")).toLowerCase(),c=s&&"-"+s+"-"||"";return f[r]||(p.insertRule("@"+c+"keyframes "+r+"{0%{opacity:"+a+"}"+i+"%{opacity:"+e+"}"+(i+.01)+"%{opacity:1}"+(i+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",p.cssRules.length),f[r]=1),r}function o(e,t){var n,o,r=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),o=0;o<d.length;o++)if(n=d[o]+t,void 0!==r[n])return n;return void 0!==r[t]?t:void 0}function r(e,t){for(var n in t)e.style[o(e,n)||n]=t[n];return e}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)void 0===e[o]&&(e[o]=n[o])}return e}function a(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function s(e,t){return"string"==typeof e?e:e[t%e.length]}function c(e){return"undefined"==typeof this?new c(e):void(this.opts=i(e||{},c.defaults,m))}function u(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}p.addRule(".spin-vml","behavior:url(#default#VML)"),c.prototype.lines=function(e,o){function i(){return r(n("group",{coordsize:l+" "+l,coordorigin:-u+" "+-u}),{width:l,height:l})}function a(e,a,c){t(f,t(r(i(),{rotation:360/o.lines*e+"deg",left:~~a}),t(r(n("roundrect",{arcsize:o.corners}),{width:u,height:o.width,left:o.radius,top:-o.width>>1,filter:c}),n("fill",{color:s(o.color,e),opacity:o.opacity}),n("stroke",{opacity:0}))))}var c,u=o.length+o.width,l=2*u,d=2*-(o.width+o.length)+"px",f=r(i(),{position:"absolute",top:d,left:d});if(o.shadow)for(c=1;c<=o.lines;c++)a(c,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(c=1;c<=o.lines;c++)a(c);return t(e,f)},c.prototype.opacity=function(e,t,n,o){var r=e.firstChild;o=o.shadow&&o.lines||0,r&&t+o<r.childNodes.length&&(r=r.childNodes[t+o],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}}var l,d=["webkit","Moz","ms","O"],f={},p=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),m={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};c.defaults={},i(c.prototype,{spin:function(t){this.stop();var n,o,i=this,s=i.opts,c=i.el=r(e(0,{className:s.className}),{position:s.position,width:0,zIndex:s.zIndex}),u=s.radius+s.length+s.width;if(t&&(t.insertBefore(c,t.firstChild||null),o=a(t),n=a(c),r(c,{left:("auto"==s.left?o.x-n.x+(t.offsetWidth>>1):parseInt(s.left,10)+u)+"px",top:("auto"==s.top?o.y-n.y+(t.offsetHeight>>1):parseInt(s.top,10)+u)+"px"})),c.setAttribute("role","progressbar"),i.lines(c,i.opts),!l){var d,f=0,p=(s.lines-1)*(1-s.direction)/2,m=s.fps,h=m/s.speed,g=(1-s.opacity)/(h*s.trail/100),b=h/s.lines;!function v(){f++;for(var e=0;e<s.lines;e++)d=Math.max(1-(f+(s.lines-e)*b)%h*g,s.opacity),i.opacity(c,e*s.direction+p,d,s);i.timeout=i.el&&setTimeout(v,~~(1e3/m))}()}return i},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(o,i){function a(t,n){return r(e(),{position:"absolute",width:i.length+i.width+"px",height:i.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/i.lines*u+i.rotate)+"deg) translate("+i.radius+"px,0)",borderRadius:(i.corners*i.width>>1)+"px"})}for(var c,u=0,d=(i.lines-1)*(1-i.direction)/2;u<i.lines;u++)c=r(e(),{position:"absolute",top:1+~(i.width/2)+"px",transform:i.hwaccel?"translate3d(0,0,0)":"",opacity:i.opacity,animation:l&&n(i.opacity,i.trail,d+u*i.direction,i.lines)+" "+1/i.speed+"s linear infinite"}),i.shadow&&t(c,r(a("#000","0 0 4px #000"),{top:"2px"})),t(o,t(c,a(s(i.color,u),"0 0 1px rgba(0,0,0,.1)")));return o},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var h=r(e("group"),{behavior:"url(#default#VML)"});return!o(h,"transform")&&h.adj?u():l=o(h,"animation"),c}),define("reader-frame",["util","endpoint","enviroment","reader-styles","spin"],function(e,t,n,o){function r(e){"hidden"!=e.css("overflow")&&(e.data("overflow",e.css("overflow")),e.css("overflow","hidden"))}function i(e){"hidden"==e.css("overflow")&&e.css("overflow",e.data("overflow"))}function a(){w=$("<div></div>").css(e.merge(o.background.base,o.background.hide))}function s(){x=$("<iframe></iframe>").css(e.merge(o.frame.base,o.frame.hide))}function c(){y=new Spinner(o.spinner)}function u(n,o){return t("webreader",e.merge(o,{_PATH_:n,parent_url:location.toString()}))}function l(){$(window).bind("message",function(t){for(;t.originalEvent;)t=t.originalEvent;return e.readcube_origin(t.origin)?"load"==t.data.type?void $(_).trigger("loaded"):void $(v).trigger(t.data.type,[t.data]):void e.log("disallowed message origin:",t.origin)})}function d(){a(),s(),c(),l()}function f(t,n){var o=arguments.callee;return o.promise=new Promise(function(o,r){var i=u(t,n||{});x.attr("src")==i?o({status:"loaded"}):(x.detach(),x.attr("src",i),$(_).one("loaded",function(){o({status:"loaded"})}),setTimeout(function(){r({error:"timeout",message:"reader_load_timeout"})},k),w.appendTo(document.body),x.appendTo(w),e.log("loading reader frame..."))})}function p(){r($(document.documentElement)),r($(document.body)),w.css(o.background.show),y.spin(w[0])}function m(){r($(document.documentElement)),r($(document.body)),w.css(o.background.show),x.css(o.frame.show),x.focus(),y.stop(),b({type:"new_session"}),e.dispatch_event("readcube.webviewer.open"),e.log("dispatch event: readcube.webviewer.open")}function h(){return new Promise(function(e,t){(f.promise||f()).then(function(t){m(),e(t)},t)})}function g(){x.css(o.frame.hide),w.css(o.background.hide),i($(document.body)),i($(document.documentElement)),reader_shown=!1}function b(e){var t=x[0].contentWindow;t.postMessage(e,x.attr("src"))}var v={},_={},y=null,w=null,x=null,k=n.production()?8e3:16e3;return v.init=d,v.load=f,v.show=h,v.hide=g,v.send=b,v.show_spinner=p,v}),define("reader-driver",["util","enviroment","ajax-promise","hash-command","get-article-size","reader-frame","page"],function(e,t,n,o,r,i,a){function s(e){(!t.production()||localStorage.getItem("readcube-debug-visual"))&&a("get_pdf_links").css("background-color",e)}function c(){return a("get_pdf_url",o.get_hash_params())}function u(){return new Promise(function(t,n){r({type:"HEAD",url:e.add_params(c(),{src:"readcube"}),done:function(e){t({size:e})},fail:function(e){n({status:e})}})})}function l(){return n.create("get_jsonp_access",{url:a("jsonp_endpoint"),data:a("jsonp_data",o.get_hash_params())})}function d(){return new Promise(function(e){x?e(x):$(w).one("size_access_message",function(){e(x)})})}function f(){return new Promise(function(e){k?e(k):$(w).one("jsonp_access_message",function(){e(k)})})}function p(e){x=e,$(w).trigger("size_access_message")}function m(e){k=e,$(w).trigger("jsonp_access_message")}function h(){$(window).bind("hashchange",_),$(i).on("close",function(){o.close_reader()}),$(i).on("jsonp_access_check",function(){f().then(i.send)}),$(i).on("get_pdf_size",function(){d().then(i.send)})}function g(){a("jsonp_endpoint")?l().then(function(e){m({type:"jsonp_access_result",result:e})},e.log_promise_fail):u().then(function(e){p({type:"pdf_size",size:e.size})},function(e){p({type:"pdf_size_fail",status:e.status})},e.log_promise_fail)}function b(){var t=e.merge({show_close:"1"},o.get_hash_params());return pdf_hash&&(t=e.merge(t,{hash:pdf_hash})),a("get_title")&&(t=e.merge(t,{title:a("get_title")})),t}function v(){s("gold"),i.load(a("get_doi"),b()).then(function(){s("lightgreen")},e.log_promise_fail)}function _(){o.is_reader_open()?(a("can_preload_reader")||v(),i.show_spinner(),i.show().then(g,function(t){e.log_promise_fail(t),location.href=c()})):i.hide()}function y(e){pdf_hash=e,s("lightpink"),h(),i.init(),a("can_preload_reader")&&v(),a("set_pdf_handler",function(e,t){if(1==e.which){e.preventDefault(),e.stopImmediatePropagation();var n=t?$.param(t):null;o.open_reader(n)}})}var w={},x=null,k=null;return{init:y}}),function(){function e(e){var t=[],n=[];for(var o in e)t.push(o),n.push(e[o]);return{keys:t,values:n}}function t(e,t){for(var n={},o=0;o<e.length;o++)n[e[o]]=t[o];return n}Promise.allHash||(Promise.allHash=function(n){return new Promise(function(o,r){var i=e(n);Promise.all(i.values).then(function(e){o(t(i.keys,e))},r)})}),Promise.raceHash||(Promise.raceHash=function(n){return new Promise(function(o,r){var i=e(n);Promise.race(i.values).then(function(e){o(t(i.keys,e))},r)})})}(),define("reader-impl",["util","endpoint","ajax-promise","status","page","hash-command","reader-driver"],function(e,t,n,o,r,i,a){function s(){return new Promise(function(e,t){n.create("get_injection_settings",{doi:r("get_doi"),origin_page:r("get_type")}).then(function(n){n.embedded_pdf_enabled?e(n):t({message:"disabled_in_dashboard"})},t)})}function c(){i.is_reader_open()&&i.remove_hash_silent(),r("init_reader")&&Promise.allHash({service_status:o.service(),html_status:o.html(r("get_doi")),injection_settings:s()}).then(function(e){a.init(e.html_status.hash)})["catch"](e.log_promise_fail)}return{init:c}}),define("referrer-access",["util","endpoint","ajax-promise","status","page"],function(e,t,n,o,r){function i(){return new Promise(function(e,t){n.create("get_referrer_access",{doi:r("get_doi"),referrer:document.referrer}).then(function(n){n.access?e(n):t({message:"referrer_access_disabled"})},t)})}function a(t){location.href=e.add_params(r("get_epdf_url"),{referrer_access_token:t.access_token})}function s(){r("init_referrer_access")&&Promise.allHash({service_status:o.service(),html_status:o.html(r("get_doi")),referrer_access:i()}).then(function(e){a(e.referrer_access)})["catch"](e.log_promise_fail)}return{init:s}}),define("popover",["util","asset"],function(e,t){function n(){return $('<div id="r3-popover"></div>').append('<div class="container"></div>').append('<div class="arrow"></div>').bind("mousedown mouseup click",function(e){e.stopImmediatePropagation()})}function o(){g.removeClass("up down left right"),g.css({top:"",left:""}),v.css({top:"",left:""})}function r(t){function n(){o(),g.addClass("up"),_=e.measure_element(b),g.css({top:k.top-$-x.height-_.height-f.top,left:j.x-T-x.width/2});var t=e.get_bounding_rect(v);return t.top-d.top>w.top}function r(){o(),g.addClass("down"),_=e.measure_element(b),g.css({top:k.bottom-$+_.height+f.bottom,left:j.x-T-x.width/2});var t=e.get_bounding_rect(v);return t.bottom+d.bottom<w.bottom}function i(){o(),g.addClass("left"),_=e.measure_element(b),g.css({top:j.y-$-x.height/2,left:k.left-T-x.width-_.width-f.left});var t=e.get_bounding_rect(v);return t.left-d.left>w.left}function a(){o(),g.addClass("right"),_=e.measure_element(b),g.css({top:j.y-$-x.height/2,left:k.right-T+_.width+f.right});var t=e.get_bounding_rect(v);return t.right+d.right<w.right}function s(e){var t=e.left>0,n=e.right>0;return n&&t?e.left>=e.right?"right":"left":n?"left":t?"right":null}function c(e){var t=e.top>0,n=e.bottom>0;return n&&t?e.top>=e.bottom?"bottom":"top":n?"top":t?"bottom":null}function u(){var t=e.get_bounding_rect(v),n={left:w.left-t.left+d.left,right:t.right-w.right+d.right},o=s(n);"left"==o&&v.css("left",Math.max(-(x.width/2)+_.width,-n.right)),"right"==o&&v.css("left",Math.min(x.width/2-_.width,n.left))}function l(){var t=e.get_bounding_rect(v),n={top:w.top-t.top+d.top,bottom:t.bottom-w.bottom+d.bottom},o=c(n);"top"==o&&v.css("top",Math.max(-(x.height/2)+_.height,-n.bottom)),"bottom"==o&&v.css("top",Math.min(x.height/2-_.height,n.top))}o();var _=null,y=h.offset(),w=e.get_bounding_rect(h),x=e.measure_element(m),k=e.get_bounding_rect(p),j={x:(k.left+k.right)/2,y:(k.top+k.bottom)/2},$=y.top-h.scrollTop(),T=y.left-h.scrollLeft();switch(t){case"up":n(),u();break;case"down":r(),u();break;case"left":i(),l();break;case"right":a(),l()}}function i(){return"visible"==g.css("visibility")}function a(e){e.anchor.is(p)&&e.content.is(m)||(p=e.anchor,m=e.content,v.children().detach(),v.append(m),g.appendTo(h)),r(e.placement),$(window).off("resize.popover"),$(window).bind("resize.popover",function(){r(e.placement)})}function s(t){a(t),g.css("visibility","visible"),e.queue_exec(function(){$(document).off("click.popover"),$(document).bind("click.popover",function(e){$(e.target).is(p)||($(document).off("click.popover"),c())})})}function c(){$(window).off("resize.popover"),$(document).off("click.popover"),g.css("visibility","hidden")}function u(e){i()?c():s(e)}function l(){return new Promise(function(n){e.get_style(t("popover.css"),n)})}var d={top:10,right:20,bottom:10,left:20},f={top:7,right:2,bottom:2,left:2},p=null,m=null,h=$(document.body),g=n(),b=g.find(".arrow"),v=g.find(".container");return{init:l,show:s,hide:c,toggle:u}}),define("sharing-toolbar",["util","endpoint","status","page","popover"],function(e,t,n,o,r){function i(){return $("<iframe></iframe>").css(s).attr("src",t("sharing_toolbar",{doi:o("get_doi"),url:o("get_epdf_url"),title:o("get_title")}))}function a(){o("init_sharing_toolbar")&&Promise.all([n.service(),n.html(o("get_doi")),r.init()]).then(function(){var e=i(),t=o("get_share_link");o("set_share_handler",function(n){1==n.which&&(n.preventDefault(),n.stopImmediatePropagation(),r.toggle({placement:"down",anchor:t,content:e}))})})["catch"](e.log_promise_fail)}var s={width:350,height:330,border:"none",outline:"none"};return{init:a}}),define("tracker",["endpoint"],function(e){function t(e){$("<iframe></iframe>").attr("src",e).css({position:"absolute",visibility:"hidden",width:0,height:0}).appendTo(document.body)}function n(n){t(e("track_checkout_show",n))}function o(n){t(e("track_checkout_fail",n))}return{checkoutShow:n,checkoutFail:o}}),define("nature-checkout",["util","endpoint","page","ajax-promise","tracker"],function(e,t,n,o,r){function i(){return $(".readcube-purchase")}function a(e){return(e/100).toFixed(2)}function s(){return new Promise(function(e,t){o.create("get_purchases_info",n("get_doi")).then(function(n){n.purchasable&&n.prices?e(n):t(n)},t)})}function c(e){r.checkoutShow({doi:n("get_doi"),publisher:"nature",price_rent:e.tier_1,price_cloud:e.tier_2,price_pdf:e.tier_3})}function u(){return t("webreader",{_PATH_:n("get_doi"),r3_referer:"nature",show_checkout:"1"})}function l(e){i().append(['<div class="mb15 access-option-body">','<h2 class="h4 title-color tighten-line-height mb4">ReadCube Access*:</h2>','<p class="text10 tighten-line-height mb20">',"<small>*printing and sharing restrictions apply</small>","</p>",'<p class="text36 title-color-light access-option-price mb0">$'+a(e.tier_1)+" ",'<span class="text24">rent</span>',"</p>",'<p class="text36 title-color-light access-option-price mb0">$'+a(e.tier_2)+" ",'<span class="text24">buy</span>',"</p>","</div>",'<a href="'+u()+'" data-test="access-option-link" class="mt4 buttony">Buy/Rent now</a>'].join(""))}function d(){return i().length&&"maestro"==i().data("type")?void s().then(function(e){l(e.prices),c(e.prices)},e.log_promise_failure):void e.log("maestro checkout container not found")}return{init:d}}),define("lang",function(){var e={epdf:{mobile_browser:"Unsupported mobile device",font_fail:"Browser font rendering test failed",unsupported_browser:"Browser lacks required HTML5 fatures",access_check_failed:"Access check failed",service_unavailable:"ReadCube reader is currently unavailable",html_unavailable:"ReadCube article HTML is currently unavailable",reader_load_timeout:"Reader frame load timed out",get_user_info_timeout:"User info timed out",get_html_status_timeout:"Html status timed out",get_article_status_timeout:"Article status timed out",get_purchases_info_timeout:"Purchase info timed out",get_service_status_timeout:"Service status timed out",get_injection_settings_timeout:"Injection settings timed out",get_readcube_access_timeout:"ReadCube access timed out",get_jsonp_access_timeout:"JSONP access timed out",get_cloud_access_timeout:"Cloud access timed out",disabled_in_localstorage:"Reader disabled in localStorage",disabled_in_dashboard:"Reader disabled in dashboard"},share:{disabled_in_localstorage:"Sharing disabled in localStorage"},checkout:{unknown_error:"An unknown error occurred",mobile_browser:"Unsupported mobile device",unsupported_browser:"Unsupported browser",ecommerce_disabled:"Checkout disabled in dashboard",article_unavailable:"Article is unavailable",article_processing:"Article is being processed",init_checkout_fail:"Checkout init failed",get_user_info_timeout:"User info timed out",get_article_status_timeout:"Article status timed out",get_purchases_info_timeout:"Purchase info timed out",get_injection_settings_timeout:"Injection settings timed out",get_readcube_access_timeout:"ReadCube access timed out",load_jquery_timeout_:"jQuery load timed out",load_script_timeout:"Script load timed out",load_style_timeout:"Stylesheet load timed out"}};return function(t){for(var n=null,o=null,r=t.split(".");(o=r.shift())&&(n=(n||e)[o]););return n}}),define("nature-strategy",["util","lang","modernizr"],function(e,t,n){function o(o){function r(){return!o||/nature\.com/.test(location.hostname)}function i(e){return n.localstorage&&!!localStorage.getItem(e)}function a(){return i("readcube-share-enabled")?l()?!0:(e.log("could not scrape doi"),!1):(e.log(t("share.disabled_in_localstorage")),!1)}function s(){return i("readcube-epdf-enabled")?l()?h().length?!0:(e.log("could not find pdf link"),!1):(e.log("could not scrape doi"),!1):(e.log(t("epdf.disabled_in_localstorage")),!1)}function c(){return a()?h().length?!0:(e.log("sharing toolbar disabled: user has no access"),!1):!1}function u(){return a()?h().length?(e.log("referrer redirect disabled: user has access"),!1):!0:!1}function l(){return $('meta[name="citation_doi"]').attr("content").substr(4)}function d(){return $('meta[name="citation_title"]').attr("content")}function f(){return 0==location.hostname.indexOf("naturesandbox")?!0:0==location.hostname.indexOf("test-www")?!0:!1}function p(){if(f())return null;var t=$('meta[name="prism.issn"]').attr("content");return e.issn_valid(t)?t:(t=$('meta[name="prism.eIssn"]').attr("content"),e.issn_valid(t)?t:(t=$(".issn").text().split(" ").pop(),e.issn_valid(t)?t:(t=$(".eissn").text().split(" ").pop(),e.issn_valid(t)?t:null)))}function m(){return"article"}function h(){return $(".download-pdf")}function g(){return $("#toggle-bookmarking-links")}function b(){$("#articlenav li.readcube").hide()}function v(e){b(),h().find("#toggle-download-links a").attr("href",k()),h().unbind("click").find("*").unbind("click"),h().click(e)}function _(e){g().unbind("click").click(e)}function y(){return!0}function w(){v(function(e){e.stopImmediatePropagation()})}function x(n){e.log(t("epdf."+n)),"mobile_browser"==n&&w()}function k(){return h().find(".articlepdf a").attr("href")}function j(){return"http://www.nature.com/articles/doi:"+l()+".epdf"}return{test:r,init_reader:s,init_sharing_toolbar:c,init_referrer_access:u,get_doi:l,get_type:m,get_issn:p,get_title:d,get_pdf_links:h,get_share_link:g,get_pdf_url:k,get_epdf_url:j,set_pdf_handler:v,set_share_handler:_,can_preload_reader:y,handle_unsupported:x}}return o}),define("nature-ar-strategy",["util","lang","modernizr"],function(e,t,n){function o(o){function r(){return(!o||/nature\.com/.test(location.hostname))&&/^\/articles/.test(location.pathname)}function i(e){return n.localstorage&&!!localStorage.getItem(e)}function a(){return i("readcube-share-enabled")?l()?!0:(e.log("could not scrape doi"),!1):(e.log(t("share.disabled_in_localstorage")),!1)}function s(){return i("readcube-epdf-enabled")?l()?h().length?!0:(e.log("could not find pdf link"),!1):(e.log("could not scrape doi"),!1):(e.log(t("epdf.disabled_in_localstorage")),!1)}function c(){return a()?h().length?(v(),!0):(e.log("sharing toolbar disabled: user has no access"),!1):!1}function u(){return a()?h().length?(e.log("referrer redirect disabled: user has access"),!1):!0:!1}function l(){return $('meta[name="citation_doi"]').attr("content").substr(4)}function d(){return $('meta[name="citation_title"]').attr("content")}function f(){return 0==location.hostname.indexOf("naturesandbox")?!0:0==location.hostname.indexOf("test-www")?!0:!1}function p(){if(f())return null;var t=$('meta[name="prism.issn"]').attr("content");return e.issn_valid(t)?t:(t=$('meta[name="prism.eIssn"]').attr("content"),e.issn_valid(t)?t:null)}function m(){return"article"}function h(){return $(P)}function g(){return $(E)}function b(){$("a.js-readcube").parent().hide()}function v(){g().replaceWith(g().clone())}function _(e){b(),h().unbind("click").click(e),$(document).delegate(P,"click",e)}function y(e){g().unbind("click").click(e),$(document).delegate(E,"click",e)}function w(){return!0}function x(){_(function(e){e.stopImmediatePropagation()})}function k(n){e.log(t("epdf."+n)),"mobile_browser"==n&&x()}function j(){return h().attr("href")}function T(){return"http://www.nature.com/articles/doi:"+l()+".epdf"}var P="a.js-readcube-pdf",E="a.js-share-link";return{test:r,init_reader:s,init_sharing_toolbar:c,init_referrer_access:u,get_doi:l,get_type:m,get_issn:p,get_title:d,get_pdf_links:h,get_share_link:g,get_pdf_url:j,get_epdf_url:T,set_pdf_handler:_,set_share_handler:y,can_preload_reader:w,handle_unsupported:k}}return o}),define("reader-v2-nature",["load-asset","hash-command","compatible","size-check","dashboard","reader-impl","referrer-access","sharing-toolbar","nature-checkout","page","nature-strategy","nature-ar-strategy"],function(e,t,n,o,r,i,a,s,c,u,l,d){o.init()||(u("init",[d(),l()]),t.process_settings(),e.jquery("1.11.0").then(function(){$(window).bind("hashchange",function(){t.process_settings(!0)}),$(function(){c.init(),n().result&&(r.init(),i.init(),a.init(),s.init())})}))}),require("reader-v2-nature");